<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nQode - Case Studies</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <!-- UPDATED: Added 'Jost' font family from the new style -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Jost:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Boxicons for the mobile menu icon -->
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">

    <style>
        /* --- 1. Global Styles & Variables --- */
        :root {
            --primary-maroon: #9f1239;
            --text-light: #ffffff;
            --text-dark: #1f2937;
            --text-muted: #d1d5db;
            --bg-body: #0c0a09;
            --bg-sticky-header: #1c1917; /* A slightly lighter dark for the sticky header */
            --bg-card-dark: #1c1917;
            --bg-card-peach: #522e25;
            --bg-card-light: #292524;
            --p-font: 1rem; /* Define this for the header styles */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            list-style: none;
	        text-decoration: none;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Jost', sans-serif; /* Using the new font */
            /* background-color: var(--bg-body); */
            color: var(--text-light);
        }

        .container {
            /* max-width: 1200px; */
            margin: 0 auto;
            padding: 1.5rem 10%; /* Match header padding */
        }

        /* --- 2. NEW: INTEGRATED HEADER STYLES --- */
        header {
            position: fixed;
            width: 100%;
            top: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: transparent;
            padding: 30px 10%;
            transition: all .35s ease;
        }
        header.sticky {
            background: var(--bg-sticky-header);
            padding: 15px 10%;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
        }

        .logo {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-light);
        }
        .logo img {
            max-width: 100%;
            width: 110px;
            height: auto;
        }
        
        .navlist {
            display: flex;
        }
        .navlist a {
            font-size: var(--p-font);
            color: var(--text-muted); /* Muted color for non-active links */
            font-weight: 500;
            padding: 10px 25px;
            position: relative;
        }
        .navlist a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            background: var(--primary-maroon);
            bottom: -3px;
            left: 0;
            transition: ease .40s;
        }
        .navlist a:hover {
            color: var(--text-light);
        }
        .navlist a:hover::after {
            width: 100%;
        }

        #menu-icon {
            font-size: 35px;
            color: var(--text-light);
            z-index: 10001;
            cursor: pointer;
            display: none; /* Hidden on desktop */
        }
        
        /* --- 3. Tag Filter Styling (Unchanged) --- */
        .main-title { font-size: 2.5rem; font-weight: 700; margin-top: 120px; margin-bottom: 1.5rem; /* Added margin-top to clear fixed header */ }
        #filters-container { display: flex; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 2.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid #3f3f46; }
        .filter-btn { background-color: #f9fafb; color: var(--text-dark); border: 1px solid #4b5563; border-radius: 8px; padding: 0.75rem 1.25rem; font-size: 0.9rem; font-weight: 600; text-transform: uppercase; cursor: pointer; transition: all 0.2s ease; }
        .filter-btn:hover { background-color: #e5e7eb; }
        .filter-btn.active { background-color: var(--primary-maroon); color: var(--text-light); border-color: var(--primary-maroon); }

        /* --- 4. Project Layout (Unchanged) --- */
        #case-studies-grid { display: flex; flex-direction: column; gap: 2.5rem; }
        .project-pair { display: flex; flex-direction: column; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .project-column { flex: 1; display: flex; flex-direction: column; }
        .project-item { width: 100%; }
        .item-tall { flex: 60; }
        .item-short { flex: 40; }
        .card-image { width: 100%; height: 100%; object-fit: cover; display: block; }
        .card-content-wrapper { padding: 2rem; display: flex; flex-direction: column; justify-content: center; height: 100%; }
        .card-tag { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 999px; font-size: 0.75rem; font-weight: 600; margin-bottom: 1rem; background-color: var(--primary-maroon); color: var(--text-light); align-self: flex-start; }
        .card-title { font-size: 1.75rem; font-weight: 600; margin-bottom: 0.75rem; line-height: 1.3; }
        .card-description { color: var(--text-muted); line-height: 1.6; margin-bottom: 1.5rem; }
        .card-link { text-decoration: none; color: var(--text-light); font-weight: 600; font-size: 0.9rem; }
        .card-link:hover { text-decoration: underline; }
        .card-theme-dark { background-color: var(--bg-card-dark); }
        .card-theme-peach { background-color: var(--bg-card-peach); }
        .card-theme-light { background-color: var(--bg-card-light); }
        
        /* --- 5. Media Queries --- */
        @media (max-width: 970px) {
            #menu-icon {
                display: block;
            }
            .navlist {
                position: absolute;
                top: -1000px; /* Hide off-screen */
                left: 0;
                right: 0;
                flex-direction: column;
                background: var(--bg-sticky-header);
                text-align: center;
                transition: all .40s;
                padding: 2rem 0;
            }
            .navlist.active {
                top: 100%; /* Bring into view */
            }
        }
        
        @media (min-width: 768px) {
            .nav-links { display: block; }
            .main-title { font-size: 3.5rem; }
            .project-pair { flex-direction: row; min-height: 80vh; }
        }
    </style>
</head>
<body>

    <!-- NEW HEADER HTML -->
    <header>
		<a href="/index.html" class="logo"><img src="../assets/images/GHlog.png"></a>
		<div class="bx bx-menu" id="menu-icon"></div>
		<ul class="navlist">
			<li><a href="/index.html#home">Home</a></li>
			<li><a href="/index.html#about">About</a></li>
			<li><a href="/index.html#portfolio">Portfolio</a></li>
			<li><a href="/index.html#service">Service</a></li>
			<li><a href="index.html#contact">Contact</a></li>
		</ul>
	</header>

    <div class="container">
        <main>
            <h1 class="main-title">Case Studies</h1>
            <div id="filters-container"></div>
            <div id="case-studies-grid"></div>
        </main>
    </div>

    <script>
        // --- 1. HEADER INTERACTIVITY ---
        const header = document.querySelector("header");
        window.addEventListener("scroll", function() {
            header.classList.toggle("sticky", window.scrollY > 0);
        });

        const menuIcon = document.querySelector("#menu-icon");
        const navlist = document.querySelector(".navlist");

        menuIcon.onclick = () => {
            menuIcon.classList.toggle("bx-x"); // Optional: change icon to an 'X'
            navlist.classList.toggle("active");
        };

        // --- 2. PROJECT FILTERING & RENDERING (Unchanged) ---
        const grid = document.getElementById('case-studies-grid');
        const filtersContainer = document.getElementById('filters-container');
        let allProjects = [];
        let activeTags = [];

        const renderCards = () => {
            let filteredProjects = [];
            if (activeTags.length === 0) {
                filteredProjects = allProjects;
            } else {
                filteredProjects = allProjects.filter(project => 
                    activeTags.every(tag => project.tags.includes(tag))
                );
            }
            
            grid.innerHTML = '';
            const themes = ['dark', 'peach', 'light'];
            for (let i = 0; i < filteredProjects.length; i += 2) {
                const project1 = filteredProjects[i];
                const project2 = filteredProjects[i + 1];
                if (!project1) continue;
                const pairContainer = document.createElement('div');
                pairContainer.className = 'project-pair';
                const leftColumn = document.createElement('div');
                leftColumn.className = 'project-column';
                const rightColumn = document.createElement('div');
                rightColumn.className = 'project-column';
                const isReversed = (i / 2) % 2 !== 0;
                const theme1 = themes[i % themes.length];
                const image1HTML = createImageBlock(project1);
                const content1HTML = createContentBlock(project1, theme1);
                let image2HTML = '', content2HTML = '';
                if (project2) {
                    const theme2 = themes[(i + 1) % themes.length];
                    image2HTML = createImageBlock(project2);
                    content2HTML = createContentBlock(project2, theme2);
                }
                const tallImage1 = image1HTML.replace('project-item', 'project-item item-tall');
                const shortContent1 = content1HTML.replace('project-item', 'project-item item-short');
                const tallImage2 = image2HTML.replace('project-item', 'project-item item-tall');
                const shortContent2 = content2HTML.replace('project-item', 'project-item item-short');
                if (isReversed) {
                    leftColumn.innerHTML = tallImage1 + shortContent2;
                    rightColumn.innerHTML = shortContent1 + tallImage2;
                } else {
                    leftColumn.innerHTML = tallImage1 + shortContent1;
                    rightColumn.innerHTML = shortContent2 + tallImage2;
                }
                pairContainer.appendChild(leftColumn);
                pairContainer.appendChild(rightColumn);
                grid.appendChild(pairContainer);
            }
        };

        const renderFilterTags = () => {
            const allTags = new Set();
            allProjects.forEach(project => {
                project.tags.forEach(tag => allTags.add(tag));
            });
            filtersContainer.innerHTML = '';
            const allButton = document.createElement('button');
            allButton.className = 'filter-btn active';
            allButton.textContent = 'All';
            allButton.dataset.filter = 'All';
            filtersContainer.appendChild(allButton);
            allTags.forEach(tag => {
                const button = document.createElement('button');
                button.className = 'filter-btn';
                button.textContent = tag;
                button.dataset.filter = tag;
                filtersContainer.appendChild(button);
            });
        };
        
        filtersContainer.addEventListener('click', (e) => {
            if (!e.target.classList.contains('filter-btn')) return;
            const clickedTag = e.target.dataset.filter;
            const allButton = filtersContainer.querySelector('[data-filter="All"]');
            if (clickedTag === 'All') {
                activeTags = [];
                filtersContainer.querySelectorAll('.filter-btn').forEach(btn => {
                    if (btn.dataset.filter !== 'All') btn.classList.remove('active');
                });
                e.target.classList.add('active');
            } else {
                allButton.classList.remove('active');
                e.target.classList.toggle('active');
                if (activeTags.includes(clickedTag)) {
                    activeTags = activeTags.filter(t => t !== clickedTag);
                } else {
                    activeTags.push(clickedTag);
                }
                if (activeTags.length === 0) {
                    allButton.classList.add('active');
                }
            }
            renderCards();
        });

        function createContentBlock(project, theme) {
            const projectLink = `/pages/project-details-template.html?id=${project.id}`;
            const description = project.overview;
            const firstTag = project.tags.length > 0 ? project.tags[0] : 'Case Study';
            return `<div class="project-item"><div class="card-content-wrapper card-theme-${theme}"><span class="card-tag">${firstTag.toUpperCase()}</span><h2 class="card-title">${project.title}</h2><p class="card-description">${description}</p><a href="${projectLink}" class="card-link">READ MORE &raquo;</a></div></div>`;
        }
        function createImageBlock(project) {
            const imageUrl = project.images[0];
            return `<div class="project-item"><img src="${imageUrl}" alt="${project.title}" class="card-image"></div>`;
        }

        async function initializePage() {
            try {
                const response = await fetch('../data/projects.json');
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                allProjects = await response.json();
                renderFilterTags();
                renderCards();
            } catch (error) {
                console.error("Could not fetch projects.json:", error);
                grid.innerHTML = `<p style="color: red;">Error loading projects. Please check the console for details.</p>`;
            }
        }
        
        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>
</html>